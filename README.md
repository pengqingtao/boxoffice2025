# BoxOffice 票房数据抓取工具

这是一个用于从 BoxOfficeMojo 网站抓取电影票房排行数据的Python工具。

## 功能特点

- 抓取指定年月的电影票房排行数据（前10名）
- 获取电影排名、英文片名、累计票房、首映日期等信息
- 自动保存数据到CSV文件
- 支持中文界面和提示

## 安装依赖

首先安装所需的Python包：

```bash
pip install -r requirements.txt
```

## 使用方法

### 方式一：单月数据抓取

**1. 运行主程序**

```bash
python boxoffice_scraper.py
```

**2. 按提示输入信息**

程序会要求你输入：
- 年份（例如：2025）
- 月份（1-12）

**3. 查看结果**

程序会：
1. 显示抓取进度
2. 展示数据预览
3. 自动保存到CSV文件（保存在 `data/` 目录下）

### 方式二：批量抓取多月数据

**1. 运行批量抓取程序**

```bash
python batch_scraper.py
```

**2. 按提示输入信息**

程序会要求你输入：
- 年份（例如：2024）
- 开始月份（1-12）
- 结束月份（1-12）

**3. 查看结果**

程序会：
1. 按顺序抓取指定月份范围的数据
2. 显示每月抓取进度和统计
3. 将所有数据合并保存到一个CSV文件

## 输出数据格式

CSV文件包含以下四列：
- `排名`: 电影在当月的票房排名
- `英文片名`: 电影的英文名称
- `累计票房`: 累计票房收入（美元）
- `首映日期`: 电影首映日期（中文格式，如：5月23日）

## 示例

```
=== BoxOfficeMojo 票房数据抓取工具 ===

请输入年份 (例如: 2025): 2024
请输入月份 (1-12): 5

开始抓取 2024年5月 的票房数据...
--------------------------------------------------
正在抓取: https://www.boxofficemojo.com/month/may/2024/?ref_=bo_ml_table_1
已抓取: 1. Kingdom of the Planet of the Apes
已抓取: 2. The Fall Guy
...
成功抓取 10 条电影数据
--------------------------------------------------
抓取完成！共获得 10 条电影数据

数据预览:
1. Kingdom of the Planet of the Apes - $171,221,615 (5月10日)
2. The Fall Guy - $92,948,106 (5月3日)
3. IF - $111,349,933 (5月17日)
...

所有数据已保存到: data/boxoffice_2024_05.csv
```

## 文件结构

```
BoxOffice/
├── boxoffice_scraper.py    # 主程序文件（单月抓取）
├── batch_scraper.py        # 批量抓取程序（多月抓取）
├── requirements.txt        # 依赖包列表
├── README.md              # 说明文档
└── data/                  # 数据保存目录
    ├── boxoffice_YYYY_MM.csv    # 单月抓取的数据文件（如：boxoffice_2025_05.csv）
    └── batch_boxoffice_YYYY_MM_to_MM.csv  # 批量抓取的数据文件
```

## 文件管理

- **单月抓取**：文件名格式为 `boxoffice_YYYY_MM.csv`（如：`boxoffice_2025_05.csv`）
- **相同年月覆盖**：如果再次抓取相同年月的数据，会覆盖旧文件，不会创建重复文件
- **批量抓取**：文件名格式为 `batch_boxoffice_YYYY_MM_to_MM.csv`

## 注意事项

1. 请遵守网站的使用条款和 robots.txt 规则
2. 程序包含适当的延时，避免对服务器造成过大压力
3. 如果抓取失败，请检查网络连接或稍后重试
4. 数据仅供学习和研究使用
5. 相同年月的数据会覆盖旧文件，如需保留历史数据请手动备份

## 技术实现

- 使用 `requests` 进行HTTP请求
- 使用 `BeautifulSoup` 解析HTML内容
- 使用 `pandas` 处理和保存数据
- 支持错误处理和用户友好的提示信息 